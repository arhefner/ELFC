; -------------------------------------------------------------------
; This file generated by ElfC, based on SubC
; SubC Copyright 2012-2025 by Nils Holm
; -------------------------------------------------------------------
#include include/ops_c.inc
#include include/os_api.inc
#include include/elfc.inc

	           proc hello

#include include/stdlib.inc

#include include/stdio.inc
	;----- cgpublic
	              public Cmain
Cmain:
  ;----- cgsetup
#ifdef STGROM
      load   r1, $F000  ; set up handler for STG Breakpoint
#endif
	;---- cgentry
	          sex   r2   				 ; make sure X = SP
	          push  rb				 		 ; save current BP (base pointer)
	          copy  r7, rb			 	 ; set BP to current ES location
	;----- begin stmt ------
	;----- cgldlab
	 				gosub s_epush16
	 				  dw  L2
	;----- cgcall
	          call  Cprintf
	;----- cgstack
	          gosub s_esmove				 ; move pointer for Expression Stack
	          dw  2  ;--- offset
	          lbdf  auto_err			 ; exit immediately when stack is exhausted by auto variables
	;---- queue dpush
	;----- push + pop data not required, data remains unchanged in RA
	;----- end stmt ------

L1:
	;----- cgexit
	          sex   r2            ; make sure X = SP
	          gosub s_stkchk      ; check for expression stack creep
	          lbdf  stk_err			 ; exit immediately when stack creep error occurs
	          pop   rb				 		 ; restore BP (base pointer)

	          rtn    			 	     ; return to caller

;----- string table

L2:
  db 'Hello, World!', 10    ;----- cgdefs
	db	$00    ;----- cgdefb
	;---- cgpostlude
	             endp
